<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Test Page - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2196F3;
            margin-bottom: 10px;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .status.checking {
            background: #FFF9C4;
            color: #F57F17;
        }
        .status.success {
            background: #C8E6C9;
            color: #2E7D32;
        }
        .status.error {
            background: #FFCDD2;
            color: #C62828;
        }
        .test-section {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px 5px 5px 0;
            font-size: 14px;
        }
        button:hover {
            background: #1976D2;
        }
        button:active {
            transform: scale(0.98);
        }
        .result {
            background: #263238;
            color: #4CAF50;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            display: none;
        }
        .result.show {
            display: block;
        }
        .success-text {
            color: #4CAF50;
            font-weight: bold;
        }
        .error-text {
            color: #f44336;
            font-weight: bold;
        }
        .info {
            background: #E3F2FD;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        .info h3 {
            color: #1976D2;
            margin-bottom: 10px;
        }
        input, select {
            padding: 8px 12px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ API Test Page - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß</h1>
        <div id="connection-status" class="status checking">
            ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...
        </div>

        <div class="info">
            <h3>üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h3>
            <p><strong>API Base URL:</strong> <span id="api-url"></span></p>
            <p><strong>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:</strong> XAMPP (Apache + MySQL) ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà</p>
            <p><strong>‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</strong> noodle_shop ‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞ import ‡πÑ‡∏ü‡∏•‡πå .sql ‡πÅ‡∏•‡πâ‡∏ß</p>
        </div>

        <!-- Menu API Tests -->
        <div class="test-section">
            <h2>üçú Menu API - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏°‡∏ô‡∏π</h2>
            <button onclick="testGetMenu()">‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <button onclick="testCreateMenu()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
            <div id="menu-result" class="result"></div>
        </div>

        <!-- Tables API Tests -->
        <div class="test-section">
            <h2>ü™ë Tables API - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏ï‡πä‡∏∞</h2>
            <button onclick="testGetTables()">‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <button onclick="testCreateTable()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
            <div id="tables-result" class="result"></div>
        </div>

        <!-- Orders API Tests -->
        <div class="test-section">
            <h2>üìù Orders API - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
            <button onclick="testGetOrders()">‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <button onclick="testCreateOrder()">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
            <div id="orders-result" class="result"></div>
        </div>

        <!-- Statistics API Tests -->
        <div class="test-section">
            <h2>üìä Statistics API - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h2>
            <select id="period-select">
                <option value="daily">‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</option>
                <option value="weekly">‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</option>
                <option value="monthly">‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                <option value="all" selected>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
            </select>
            <button onclick="testGetStatistics()">‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</button>
            <div id="stats-result" class="result"></div>
        </div>

        <!-- Auth API Tests -->
        <div class="test-section">
            <h2>üîê Authentication API - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</h2>
            <input type="password" id="admin-password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (111223)" value="111223">
            <button onclick="testLogin()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô</button>
            <button onclick="testCheckAuth()">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</button>
            <button onclick="testLogout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
            <div id="auth-result" class="result"></div>
        </div>
    </div>

    <script>
        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î API Base URL
        const API_BASE_URL = window.location.origin + '/noodle-shop/api';
        
        // ‡πÅ‡∏™‡∏î‡∏á API URL
        document.getElementById('api-url').textContent = API_BASE_URL;

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API
        async function callAPI(endpoint, method = 'GET', data = null) {
            try {
                const options = {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json'
                    }
                };

                if (data && (method === 'POST' || method === 'PUT')) {
                    options.body = JSON.stringify(data);
                }

                const response = await fetch(API_BASE_URL + endpoint, options);
                const result = await response.json();
                
                return {
                    success: true,
                    status: response.status,
                    data: result
                };
            } catch (error) {
                return {
                    success: false,
                    error: error.message
                };
            }
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
        function showResult(elementId, result, success) {
            const element = document.getElementById(elementId);
            element.classList.add('show');
            
            if (success) {
                element.innerHTML = `<span class="success-text">‚úì ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</span>\n\n` + 
                    JSON.stringify(result, null, 2);
            } else {
                element.innerHTML = `<span class="error-text">‚úó ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</span>\n\n` + 
                    JSON.stringify(result, null, 2);
            }
        }

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        async function checkConnection() {
            const statusEl = document.getElementById('connection-status');
            
            try {
                const result = await callAPI('/menu.php');
                
                if (result.success && result.data.success) {
                    statusEl.className = 'status success';
                    statusEl.textContent = '‚úì ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                } else {
                    throw new Error('API ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                }
            } catch (error) {
                statusEl.className = 'status error';
                statusEl.innerHTML = '‚úó ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ<br>' + 
                    '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: XAMPP (Apache + MySQL) ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà<br>' +
                    '‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• noodle_shop ‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà';
            }
        }

        // Test Menu API
        async function testGetMenu() {
            const result = await callAPI('/menu.php?active_only=true');
            showResult('menu-result', result, result.success);
        }

        async function testCreateMenu() {
            const menuData = {
                name: '‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏î‡∏™‡∏≠‡∏ö ' + new Date().getTime(),
                normal_price: 45,
                special_price: 55
            };
            const result = await callAPI('/menu.php', 'POST', menuData);
            showResult('menu-result', result, result.success);
            
            if (result.success) {
                setTimeout(() => alert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'), 500);
            }
        }

        // Test Tables API
        async function testGetTables() {
            const result = await callAPI('/tables.php');
            showResult('tables-result', result, result.success);
        }

        async function testCreateTable() {
            const tableNumber = Math.floor(Math.random() * 900) + 100;
            const tableData = {
                table_number: tableNumber
            };
            const result = await callAPI('/tables.php', 'POST', tableData);
            showResult('tables-result', result, result.success);
            
            if (result.success) {
                setTimeout(() => alert('‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏ï‡πä‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÇ‡∏ï‡πä‡∏∞‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç: ' + tableNumber), 500);
            }
        }

        // Test Orders API
        async function testGetOrders() {
            const result = await callAPI('/orders.php');
            showResult('orders-result', result, result.success);
        }

        async function testCreateOrder() {
            const orderData = {
                table_number: 5,
                total: 100,
                items: [
                    {
                        name: '‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß‡∏ô‡πâ‡∏≥‡πÉ‡∏™',
                        normalQty: 2,
                        specialQty: 0,
                        normalPrice: 50,
                        specialPrice: 60,
                        noodleType: '‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏•‡πá‡∏Å',
                        meatballs: ['‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏´‡∏°‡∏π', '‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠'],
                        vegetables: ['‡∏ú‡∏±‡∏Å‡∏ö‡∏∏‡πâ‡∏á'],
                        note: '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏à‡∏≤‡∏Å API',
                        total: 100
                    }
                ]
            };
            const result = await callAPI('/orders.php', 'POST', orderData);
            showResult('orders-result', result, result.success);
            
            if (result.success) {
                setTimeout(() => alert('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç: ' + result.data.data.order_number), 500);
            }
        }

        // Test Statistics API
        async function testGetStatistics() {
            const period = document.getElementById('period-select').value;
            const result = await callAPI('/statistics.php?period=' + period);
            showResult('stats-result', result, result.success);
        }

        // Test Auth API
        async function testLogin() {
            const password = document.getElementById('admin-password').value;
            const result = await callAPI('/auth.php', 'POST', { password: password });
            showResult('auth-result', result, result.success);
        }

        async function testCheckAuth() {
            const result = await callAPI('/auth.php');
            showResult('auth-result', result, result.success);
        }

        async function testLogout() {
            const result = await callAPI('/auth.php', 'DELETE');
            showResult('auth-result', result, result.success);
        }

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        window.addEventListener('DOMContentLoaded', checkConnection);
    </script>
</body>
</html>